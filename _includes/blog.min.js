!function(){function e(){fetch("/api/posts.json").then(function(e){return e.json()}).then(function(e){if("string"==typeof e&&(e=JSON.parse(e)),!(e.length<2)){var r,o=[],a=n();e.filter(function(e){return e.url===location.pathname?(r=e,!1):0!==e.tags.length}).forEach(function(e){if(r){e.sim=a[e.url]?0:t(e.tags,r.tags);for(var n=0;n<o.length;n++){var l=o[n];if(l.sim<e.sim){o.splice(n,0,e),e=null;break}}for(e&&o.push(e);o.length>3;)o.pop()}}),console.log("similar posts:",o);var l=document.querySelector(".post-pager .previous"),i=document.querySelector(".post-pager .next"),s=l&&l.getAttribute("href"),u=i&&i.getAttribute("href");if(o.length&&s===o[0].url&&o.shift(),o.length&&u===o[0].url&&o.shift(),o.length){var c=o[0],f=document.querySelector(".post-pager .recommend");f.setAttribute("href",c.url),f.textContent="推荐阅读："+c.title,f.style.display="block"}else console.info("no similar posts found, recommendation disabled")}})}function t(e,t){var r={};e.forEach(function(e){r[e]=!0});var n=t.filter(function(e){return r[e]}).length;return n/Math.sqrt(e.length)/Math.sqrt(t.length)}function r(){var e=n(),t=location.pathname;e[t]=(e[t]||0)+1,window.sessionStorage.setItem("pv",JSON.stringify(e))}function n(){var e=window.sessionStorage.getItem("pv");return e?JSON.parse(e):{}}r(),e()}(),function(){function e(){function e(){var e=window.pageYOffset<l?"affix-top":"affix";n.setAttribute("class",e);var t;for(Array.prototype.forEach.call(n.querySelectorAll("a"),function(e){var r=e.getAttribute("href"),n=document.querySelector(r);window.pageYOffset>n.offsetTop-20&&(t=e),e.parentNode.removeAttribute("class")});t;)t.parentNode.classList.add("active"),t=t.parentNode.parentNode.previousElementSibling}var o=t(r),a=document.querySelector("article");if(!o)return void a.classList.add("collapsed");n.appendChild(o);var l=406;window.addEventListener("scroll",e)}function t(e){var t=document.createElement("ul");t.setAttribute("class","nav level-0 list-unstyled sidenav");for(var r=1;!e.querySelector("h"+r)&&7>r;)r+=1;return 7===r?null:(Array.prototype.forEach.call(e.querySelectorAll("h1,h2,h3,h4,h5,h6"),function(e,n){var o="header-"+n;e.setAttribute("id",o);var a=parseInt(e.nodeName.substr(1)),l=a-r,i=document.createElement("li");i.innerHTML='<a href="#'+o+'">'+e.textContent+'</a><ul class="nav list-unstyled level-'+(l+1)+'"/>';var s=document.createElement("div");s.appendChild(t);var u=s.querySelectorAll("ul.level-"+l);u[u.length-1].appendChild(i)}),t)}var r=document.querySelector(".md"),n=window.asideTOC;e()}();